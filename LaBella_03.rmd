---
title: "LaBella_03"
author: "Rachel LaBella"
date: "September 22, 2016"
output: html_document
---
```{r, echo = TRUE}
library(readr)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(forcats)
library(tibble)
```
###1) Complete problems 10 and 17-18 on pg. 109-111. Use R where possible. Data sets (so you donâ€™t have to type things in) are available at http://www.zoology.ubc.ca/~whitlock/ABD/teaching/datasets.html.

###Problem 10
####a)
``` {r, echo = TRUE}
gene_reg <- read_csv("../04q11NumberGenesRegulated.csv")
gene_reg
str(gene_reg)
gene_reg %>%
  summarize(avg_ngenes = mean(ngenes))
std.error <- (14.5)/sqrt(26)
1.96*2.843683
```
####b)
I am 95% confident the true mean will fall between 20.073 and 8.927. (14.5 +/- 5.573) 20.072 is the upper limit, 8.927 is the lower limit of the confidence interval. 14.5 is the true mean of ngenes. 

###Problem 17
Instead of saying that there is a 95% chance that it will fall within those ranges, they should have said we are 95% confident that the true mean will fall within the upper and lower confidence limits. There is no probability involved in calculating confidence intervals, the true mean either is or is not between the upper and lower limits. The upper and lower limits (0.9 and 3.1) are constants. 

###Problem 18
```{r, echo = TRUE}
#a) 
corpse_flower <- c(51, 45, 61, 76, 11, 117, 7, 132, 52, 149)
mean(corpse_flower)
sd(corpse_flower)

#b)
std.error.flwr <- (70.1)/sqrt(10)

#c)
conf_int <- 1.96*22.1675663977803
#Upper limit:
48.50074 + 43.448430

#Lower limit:
48.50074 - 43.448430
```
####d)
I would say that the mean would be about the same, the range of the numbers would be different but the average would be about the same. Unless all of the random points were on either end of the mean and it would push the mean higher or lower. 

####e)
The standard deviation would be less than the original sample because the more data points you have, the more accurate the mean and more narrow the standard deviation.

####f)
The standard errors would be less as well. With the same idea as the standard deviation, the more points you have in your sample, the more accurate the standard errors. 

####2.1) Load the data using readr and make the Month_Names column into a factor whose levels are in order of month.
``` {r, echo = TRUE}
sea_ice <- read_csv("../sea_ice.csv")
sea_ice <- sea_ice %>%
  mutate(month_name = fct_inorder(month_name))
levels(sea_ice$month_name)
```

####2.2) Make a boxplot showing the variability in sea ice extent every month.
``` {r, echo = TRUE}
sea_ice_plot <- ggplot(sea_ice, mapping = aes(x = month_name, y = extent)) 
sea_ice_plot +
  geom_boxplot()
```


####2.3) Use dplyr to get the annual minimum sea ice. Plot minimum ice by year, and add a trendline (either a smooth spline or a straight line).
``` {r, echo = TRUE}
sea_ice_min <- sea_ice %>%
  group_by(year) %>%
  slice(which.min(extent)) 
list(sea_ice_min)

sea_ice_min_plot <- ggplot(data = sea_ice_min, mapping = aes(x = year, y = extent))
sea_ice_min_plot +
  geom_jitter() +
  theme_bw(base_size = 10) +
  stat_smooth(method = "gam", color = "red")

```


####2.4) Plot sea ice by year, with different lines for different months. Then, add a new column (mutate!) using the ggplot2 function cut_interval(Month, n=4) - this will create four even bins. Seasons, if you will. Use facet_wrap on the same plot and split the plot into seasons.
``` {r, echo = TRUE}
library(viridis)
sea_ice_month <- ggplot(sea_ice, mapping = aes(year, extent, group = month, color = month))
sea_ice_month +
  geom_line() +
  scale_color_viridis()

#############
season_names <- list(
  '(1,3.75)'='Winter',
  '(3.75,6.5)'='Spring',
  '(6.5,9.25)'='Summer',
  '(9.25,12)'='Fall')

season_labeller <- function(variable,value){
  return(season_names[value])}

sea_ice_season <- sea_ice %>%
  mutate(season = cut_interval(month, n=4))
ggplot(sea_ice_season) +
  geom_line(mapping = aes(year, extent, group = month, color = month)) +
  facet_wrap(~season, labeller=season_labeller) +
  scale_color_viridis() +
  theme_bw()

```


####2.5) Last, make a line plot of sea ice by month. Gussy it up with colors by year, a different theme, and whatever other annotations, changes to axes, etc., you think best show the story of this data.
``` {r, echo = TRUE}
ggplot(data=sea_ice) +
  geom_line(mapping = aes(month_name, extent, color = year, size = 8)) +
  scale_color_viridis() +
  theme_bw(base_size = 12) 
```

